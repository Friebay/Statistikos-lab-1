---
title: "Statistikos 1 laboratorinis darbas: Matematinė statistika"
author: ""
date: "2025-03-12"
output:
---

### 1. Aprašykite nagrinėjamo a.d. skirstinį. Pateikite pavyzdžių, kur jis taikomas.

Logistinis skirstinys yra simetriškas, turi vieną viršūnę ir savo forma panašus į normalųjį pasiskirstymą, centruotas aplink $\mu$, pasiskirstymas priklauso nuo nuo $\sigma$ parametro.[^1] Logistinis skirstinys naudojamas logistinėje regresijoje, augimo modeliavime, siekiant aprašyti gyventojų skaičiaus augimą ir ligų plitimą, taip pat naudojamas neuroniniuose tinkluose, fizikoje, sporto modeliavime ir finansuose.[^2]

[^1]: <https://www.statisticshowto.com/logistic-distribution/>

[^2]: <https://www.sciencedirect.com/topics/mathematics/logistic-distribution>

### 2. Užrašykite nagrinėjamo a.d. pasiskirstymo ir tankio funkcijas (tolydžiu atveju) arba tikimybes (diskrečiu atveju).

Pasiskirstymo funkcija (reikės parašyti ką reiškia kiekviena raidė): $$
F(x) = \frac{1}{1 + e^{-\frac{(x - \mu)}{\sigma}}}
$$

Tankio funkcija (reikės parašyti ką reiškia kiekviena raidė): $$
f(x) = \frac{\sigma^{-1} e^{(x-\mu)/\sigma}}{(1 + e^{(x-\mu)/\sigma})^2}
$$

### 3. Užrašykite kam lygūs šio a.d. vidurkis, dispersija asimetrijos ir eksceso koeficientai.

• Vidurkis $\mu$

• Dispersija $\frac{\pi^2}{3\sigma^2}$

• Asimetrijos koeficientas 0

• Eksceso koeficientas 6/5

### 4. Išbrėžkite a.d. tankio (tikimybių) ir pasiskirstymo funkcijos grafikus su skirtingais parametrų rinkiniais. Kaip parametrai keičia tankio funkcijų (tikimybių) formas?

Pasirinkti parametrų rinkiniai:

```         
location = 0, scale = 1;
location = 4 , scale = 2;
location = 8, scale = 3.
```

Tankio grafikų vizualizavimas

```{r}
x <- -10:20
plot(x, dlogis(x, location = 0, scale = 1), type = "h", col = "darkblue")
```

```{r}
plot(x, dlogis(x, location = 4, scale = 2), type = "h", col = "darkblue")
```

```{r}
plot(x, dlogis(x, location = 8, scale = 3), type = "h", col = "darkblue")
```

Iš aukščiau pateiktų grafikų matome, kad:

1.  Parametras μ (location) nustato kreivės centro poziciją (vidurkį).
2.  Parametras σ (scale) keičio skirstinio plotį - didesnis σ reiškia platesnį skirstinį su žemesne viršūne.

Pasiskirstymo grafikų vizualizavimas

```{r}
x <- seq(-10, 20, by=0.05)
plot(x, plogis(x, location = 0, scale = 1), type = "l", col = "darkblue")
```

```{r}
plot(x, plogis(x, location = 4, scale = 2), type = "l", col = "darkblue")
```

```{r}
plot(x, plogis(x, location = 8, scale = 3), type = "l", col = "darkblue")
```

### 5. Užrašykite kvantilių funkciją ir išbrėžkite jos grafiką su skirtingais parametrais. Kaip keičiasi kvantilių grafikas, keičiant parametrus?

```{r}
p <- seq(0.05,0.95,by = 0.05)
plot(p, qlogis(p, location = 0, scale = 1), type = "h", col = "darkblue")
```

```{r}
plot(p, qlogis(p, location = 4, scale = 2), type = "h", col = "darkblue")
```

```{r}
plot(p, qlogis(p, location = 8, scale = 3), type = "h", col = "darkblue")
```

kaip keiciasi?

### 6. Fiksuokite vieną, pasirinktą a.d. parametrų rinkinį. Sugeneruokite iš savo skirstinio duomenų rinkinius su 20, 50, 200, 1000 imčių dydžiais:

```{r}
location <- 4
scale <- 2
n<-c(20, 50, 200, 1000)
set.seed(58)
x1<-rlogis(n[1], location, scale)
set.seed(58)
x2<-rlogis(n[2], location, scale)
set.seed(58)
x3<-rlogis(n[3], location, scale)
set.seed(58)
x4<-rlogis(n[4], location, scale)
```

#### 6.1 Nubrėžkite histogramas (stulpelių diagramas).

```{r}
library(ggplot2)
histograma1 <- ggplot(data.frame(x1), aes(x=x1)) +
  geom_histogram(aes(y=after_stat(density)), binwidth = 1,
                 colour="black", fill="white") +
  geom_density(alpha=.2, fill="darkblue")
histograma1
```

```{r}

histograma2 <- ggplot(data.frame(x2), aes(x=x2)) +
  geom_histogram(aes(y=after_stat(density)), binwidth = 1,
                 colour="black", fill="white") +
  geom_density(alpha=.2, fill="darkblue")
histograma2
```

```{r}
histograma3 <- ggplot(data.frame(x3), aes(x=x3)) +
  geom_histogram(aes(y=after_stat(density)), binwidth = 0.5,
                 colour="black", fill="white") +
  geom_density(alpha=.2, fill="darkblue")
histograma3
```

```{r}

histograma4 <- ggplot(data.frame(x4), aes(x=x4)) +
  geom_histogram(aes(y=after_stat(density)), binwidth = 0.5,
                 colour="black", fill="white") +
  geom_density(alpha=.2, fill="darkblue")
histograma4
```

#### 6.2 Nubrėžkite empirines pasiskirstymo funkcijas.

```{r}
ex1 <- ecdf(x1)
plot(ex1)
```

```{r}
ex2 <- ecdf(x2)
plot(ex2)
```

```{r}
ex3 <- ecdf(x3)
plot(ex3)
```

```{r}
ex4 <- ecdf(x4)
plot(ex4)
```

#### 6.3 Raskite empirinį vidurkį, dispersiją, standartinį nuokrypį, asimetrijos ir eksceso koeficientus. Palyginti šias charakteristikas su tikromis reikšmėmis.

```{r}
library(e1071)

# rinkinio su 20 imties dydziu
mean(x1)
var(x1)
sd(x1)
skewness(x1)
kurtosis(x1) 
```

```{r}
# rinkinio su 50 imties dydziu
mean(x2)
var(x2)
sd(x2)
skewness(x2)
kurtosis(x2) 
```

```{r}
# rinkinio su 200 imties dydziu
mean(x3)
var(x3)
sd(x3)
skewness(x3)
kurtosis(x3)
```

```{r}
# rinkinio su 1000 imties dydziu
mean(x4)
var(x4)
sd(x4)
skewness(x4)
kurtosis(x4)
```

### 7. Apskaičiuokite a.d. parametro(-ų) momentų metodo įvertinį(-ius) ir raskite momentų metodo įverčius 6 dalyje sugeneruotoms imtims.

A.d. parametrų momentų metodo įvertiniai

```{r}


```

Momentų metodo įverčiai 6 dalyje sugeneruotoms imtims.

```{r}

set.seed(58)
rand_logistic <- rlogis(x1, location = 4, scale = 2 )

m_logistic <- mean(rand_logistic)
s_logistic <- var(rand_logistic)

#MM
hat_mu <- m_logistic
hat_s <- sqrt(3 * s_logistic / pi^2)
hat_mu
hat_s
```

```{r}
set.seed(58)
rand_logistic <- rlogis(x2, location = 4, scale = 2 )

m_logistic <- mean(rand_logistic)
s_logistic <- var(rand_logistic)

#MM
hat_mu <- m_logistic
hat_s <- sqrt(3 * s_logistic / pi^2)
hat_mu
hat_s
```

```{r}
set.seed(58)
rand_logistic <- rlogis(x3, location = 4, scale = 2 )

m_logistic <- mean(rand_logistic)
s_logistic <- var(rand_logistic)

#MM
hat_mu <- m_logistic
hat_s <- sqrt(3 * s_logistic / pi^2)
hat_mu
hat_s
```

```{r}
set.seed(58)
rand_logistic <- rlogis(x4, location = 4, scale = 2 )

m_logistic <- mean(rand_logistic)
s_logistic <- var(rand_logistic)

#MM
hat_mu <- m_logistic
hat_s <- sqrt(3 * s_logistic / pi^2)
hat_mu
hat_s
```

### 8. Naudodamiesi R raskite didžiausio tikėtinumo metodo parametrų įverčius 6 dalyje sugeneruotoms imtims.

```{r}
library(maxLik)

logLikFun <- function(param) {
  location <- param[1]
  scale <- param[2]
  sum(dlogis(x1, location = location,
            scale = scale, log = TRUE))
}
mle <- maxLik(logLik = logLikFun,
              start = c(location = 0, scale = 1))
summary(mle)
coef(mle)
stdEr(mle)

#Rezultatas?
```

```{r}

logLikFun <- function(param) {
  location <- param[1]
  scale <- param[2]
  sum(dlogis(x2, location = location,
             scale = scale, log = TRUE))
}
mle <- maxLik(logLik = logLikFun,
              start = c(location = 0, scale = 1))
summary(mle)
coef(mle)
stdEr(mle)

#Rezultatas??
```

```{r}
logLikFun <- function(param) {
  location <- param[1]
  scale <- param[2]
  sum(dlogis(x3, location = location,
             scale = scale, log = TRUE))
}
mle <- maxLik(logLik = logLikFun,
              start = c(location = 0, scale = 1))
summary(mle)
coef(mle)
stdEr(mle)

#Rezultatas??
```

```{r}
logLikFun <- function(param) {
  location <- param[1]
  scale <- param[2]
  sum(dlogis(x4, location = location,
             scale = scale, log = TRUE))
}
mle <- maxLik(logLik = logLikFun,
              start = c(location = 0, scale = 1))
summary(mle)
coef(mle)
stdEr(mle)


```

### 9. Palyginkite 7 ir 8 dalyse gautus įverčius su tikraisiais parametrais.

```{r}

```

### 10. Raskite parametrų pasikliautinus intervalus bei apskaičiuokite juos 6 dalyje sugeneruotiems duomenims.

```{r}

```

### 11. Apskaičiuokite 6 dalyje sugeneruotiems duomenims kvartilius.

```{r}

```

### 12. Pridėkite 5 išsiskiriančius stebėjimus 6 dalyje sugeneruotiems duomenims.

```{r}

set.seed(58)
x11 <- sample(c(x1, 30, 50 ,60, 70, 80))

table(x1)
table(x11)

```

```{r}

set.seed(58)
x22 <- sample(c(x2, 30, 50 ,60, 70, 80))

table(x2)
table(x22)
```

```{r}

set.seed(58)
x33 <- sample(c(x3, 30, 50 ,60, 70, 80))

table(x3)
table(x33)
```

```{r}

set.seed(58)
x44 <- sample(c(x4,30, 50 ,60, 70, 80))

table(x4)
table(x44)
```

### 13. Išbrėžkite stačiakampes diagramas. Ar jos identifikuoja tas pačias išskirtis?

```{r}
boxplot(x1)
boxplot(x11)
boxplot(x11)$out
```

```{r}
boxplot(x2)
boxplot(x22)
boxplot(x22)$out
```

```{r}
boxplot(x3)
boxplot(x33)
boxplot(x33)$out
```

```{r}
boxplot(x4)
boxplot(x44)
boxplot(x44)$out
```

Isskirtys?

## 14. Palyginkite 6 dalyje sugeneruotų duomenų histogramas (tikimybes) su normaliojo skirstinio tankiu (Puasono skirstinio tikimybėmis).

```{r}

```

### 15. Papildoma užduotis

```{r}

```
